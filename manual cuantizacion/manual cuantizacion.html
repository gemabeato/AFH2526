<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual T√©cnico: Cuantizaci√≥n y Optimizaci√≥n de LLMs</title>
    <style>
        :root {
            --bg-dark: #020617;
            --card-dark: #0f172a;
            --primary-blue: #38bdf8;
            --accent-purple: #818cf8;
            --accent-red: #ef4444;
            --code-green: #4ade80;
            --text-light: #f1f5f9;
            --text-muted: #94a3b8;
            --border-color: #334155;
        }

        body {
            font-family: 'Inter', -apple-system, system-ui, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
            padding: 40px 20px;
        }

        .container { max-width: 900px; margin: 0 auto; }

        header {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #1e293b 0%, #020617 100%);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            margin-bottom: 40px;
        }

        h1 { margin: 0; font-size: 2.5rem; color: var(--primary-blue); text-shadow: 0 0 15px rgba(56, 189, 248, 0.3); }
        .version { color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; }

        .section-card {
            background: var(--card-dark);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        h2 { color: var(--accent-purple); font-size: 1.5rem; display: flex; align-items: center; gap: 12px; }
        h2::before { content: "‚Ä∫"; font-size: 2rem; color: var(--primary-blue); }

        .desc { color: var(--text-muted); margin-bottom: 20px; }

        .code-container {
            background: #000;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--primary-blue);
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 15px 0;
            overflow-x: auto;
        }

        .comment { color: #64748b; font-style: italic; }
        .cmd { color: var(--code-green); font-weight: bold; }
        .arg { color: #f472b6; }

        /* --- SECCI√ìN DE RESULTADOS --- */
        .evidence-container {
            margin-top: 60px;
            text-align: center;
            border-top: 1px solid var(--border-color);
            padding-top: 40px;
        }

        .comparison-label {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .label-box {
            padding: 15px;
            border-radius: 8px;
            background: #1e293b;
            border-bottom: 3px solid var(--primary-blue);
            border: 1px solid var(--border-color);
        }

        /* ESTILO CORREGIDO: SIN RECORTE, IMAGEN COMPLETA */
        .crop-window {
            width: 100%;
            /* Quitamos la altura fija y el overflow para que se vea todo */
            padding: 10px;
            border: 2px solid var(--primary-blue);
            border-radius: 15px;
            background: transparent; /* Quitamos el fondo negro */
            margin: 25px 0;
        }

        .crop-window img {
            width: 100%;       /* Ocupa el ancho disponible */
            height: auto;      /* Mantiene la proporci√≥n */
            display: block;
            border-radius: 8px;
        }
        
        footer { text-align: center; color: var(--text-muted); font-size: 0.8rem; margin-top: 60px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <span class="version">Hecho por Gema Beato</span>
        <h1>Manual Cuantizaci√≥n</h1>
    </header>

    <div class="section-card">
        <h2>Pasos Previos: Construcci√≥n del Ecosistema</h2>
        <p class="desc">Antes de la cuantizaci√≥n, es vital preparar el entorno y el modelo base fusionado. 
Hemos usado los mismos modelos de la pr√°ctica de creaci√≥n de LLM ya que en esa tarea ya hicimos la cuantizaci√≥n. Por lo que los pasos previos son los mismos que en la otra tarea. A continuaci√≥n pondremos un resumen.</p>
        
        <p><strong>1. Inicializaci√≥n y Dependencias:</strong> Instalamos MLX (nativo para Apple Silicon) y CMake.</p>
        <div class="code-container">
            <span class="comment"># Cargar motor MLX</span><br>
            <span class="cmd">source</span> venv/bin/activate<br>
            <span class="cmd">pip</span> install mlx-lm cmake
        </div>

        <p><strong>2. Compilaci√≥n del Motor:</strong> Construimos <code>llama.cpp</code> optimizado para GPU Metal.</p>
        <div class="code-container">
            <span class="cmd">cd</span> llama.cpp<br>
            <span class="cmd">cmake</span> -B build<br>
            <span class="cmd">cmake</span> --build build --config Release -j
        </div>

        <p><strong>3. Entrenamiento y Fusi√≥n:</strong> Unimos los pesos entrenados con el modelo base.</p>
        <div class="code-container">
            <span class="cmd">python</span> -m mlx_lm.lora <span class="arg">--config</span> config_chef.yaml <span class="arg">--train</span><br>
            <span class="cmd">python</span> -m mlx_lm.fuse <span class="arg">--model</span> microsoft/Phi-3-mini-4k-instruct <span class="arg">--adapter-path</span> adapters <span class="arg">--save-path</span> merged_model
        </div>
    </div>

    <div class="section-card">
        <h2>La Cuantizaci√≥n: Reducci√≥n de Bits</h2>
        <p><strong>Paso A: Conversi√≥n Master GGUF (F16)</strong></p>
        <div class="code-container">
            <span class="cmd">python</span> llama.cpp/convert_hf_to_gguf.py merged_model <span class="arg">--outfile</span> chef-bot-f16.gguf
        </div>

        <p><strong>Paso B: Ejecuci√≥n de Cuantizaci√≥n (Q4_K_M)</strong></p>
        <div class="code-container">
            <span class="cmd">./llama.cpp/build/bin/llama-quantize</span> chef-bot-f16.gguf chef-bot-q4.gguf q4_k_m
        </div>
    </div>

    <section class="evidence-container">
        <h2>üìä Resultados de la Optimizaci√≥n</h2>
        
        <div class="comparison-label">
            <div class="label-box">
                <strong>Modelo Original (F16)</strong><br>
                <span style="color: var(--accent-red)">~7.12 GB</span>
            </div>
            <div class="label-box">
                <strong>Modelo Cuantizado (Q4)</strong><br>
                <span style="color: var(--primary-blue)">~2.23 GB</span>
            </div>
        </div>

        <div class="crop-window">
            <img src="cuantizacion.jpg" alt="Prueba visual de cuantizaci√≥n">
        </div>
        <p class="desc"><em>Evidencia visual de la reducci√≥n de peso en disco.</em></p>
    </section>
<div class="section-card">
        
        <p class="desc">A parte de la reducci√≥n de peso en disco, tambi√©n se reducen los tk/s en el modelo cuantizado comparado con el modelo original, reduciendo los tokens mas de la mitad.</p>
</div>

    <footer>
        <p>Hecho por Gema Beato </p>
    </footer>
</div>

</body>
</html>